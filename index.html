<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#1a73e8">
    <meta name="description" content="Librus Synergia - Wiadomości PWA">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Librus MSG">

    <title>Librus Wiadomości</title>

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

<!--    &lt;!&ndash; Ikony dla iOS &ndash;&gt;-->
<!--    <link rel="apple-touch-icon" href="icons/icon-192.png">-->

<!--    &lt;!&ndash; Favicon &ndash;&gt;-->
<!--    <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-32.png">-->

    <!-- Style -->
    <link rel="stylesheet" href="style.css?v=1.4">
</head>
<body>
<!-- Ekran ładowania -->
<div id="loading-screen" class="loading-screen">
    <div class="spinner"></div>
    <p>Ładowanie...</p>
</div>

<!-- Ekran logowania -->
<div id="login-screen" class="screen">
    <div class="login-container">
        <div class="login-header">
            <div class="logo">
                <svg viewBox="0 0 24 24" width="64" height="64">
                    <path fill="#1a73e8" d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                </svg>
            </div>
            <h1>Librus Wiadomości</h1>
            <p class="subtitle">Zaloguj się do Synergia</p>
        </div>

        <form id="login-form" class="login-form">
            <div class="form-group">
                <label for="username">Login</label>
                <input type="text" id="username" name="username" required
                       autocomplete="username" placeholder="Wprowadź login">
            </div>

            <div class="form-group">
                <label for="password">Hasło</label>
                <input type="password" id="password" name="password" required
                       autocomplete="current-password" placeholder="Wprowadź hasło">
            </div>

            <div class="form-group checkbox-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="remember-me" checked>
                    <span class="checkmark"></span>
                    Zapamiętaj dane logowania
                </label>
            </div>

            <button type="submit" id="login-btn" class="btn btn-primary">
                <span class="btn-text">Zaloguj się</span>
                <span class="btn-loader"></span>
            </button>

            <div id="login-error" class="error-message"></div>
        </form>

        <div class="login-footer">
            <p>Aplikacja nieoficjalna</p>
        </div>
    </div>
</div>

<!-- Główny ekran z wiadomościami -->
<div id="main-screen" class="screen hidden">
    <!-- Nagłówek -->
    <header class="app-header">
        <h1>Wiadomości</h1>
        <div class="header-actions">
            <button id="refresh-btn" class="icon-btn" title="Odśwież">
                <svg viewBox="0 0 24 24" width="24" height="24">
                    <path fill="currentColor" d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
                </svg>
            </button>
            <button id="logout-btn" class="icon-btn" title="Wyloguj">
                <svg viewBox="0 0 24 24" width="24" height="24">
                    <path fill="currentColor" d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"/>
                </svg>
            </button>
        </div>
    </header>

    <!-- Zakładki -->
    <div class="tabs">
        <button class="tab active" data-folder="received">Odebrane</button>
    </div>

    <!-- Pull to refresh indicator -->
    <div id="pull-indicator" class="pull-indicator">
        <div class="pull-spinner"></div>
        <span>Pociągnij, aby odświeżyć</span>
    </div>

    <!-- Lista wiadomości -->
    <div id="messages-container" class="messages-container">
        <div id="messages-list" class="messages-list">
            <!-- Wiadomości będą dodawane dynamicznie -->
        </div>

        <!-- Stan pusty -->
        <div id="empty-state" class="empty-state hidden">
            <svg viewBox="0 0 24 24" width="64" height="64">
                <path fill="#ccc" d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
            </svg>
            <p>Brak wiadomości</p>
        </div>

        <!-- Loader -->
        <div id="messages-loader" class="messages-loader">
            <div class="spinner"></div>
        </div>
    </div>

    <!-- Pasek statusu offline -->
    <div id="offline-bar" class="offline-bar hidden">
        <svg viewBox="0 0 24 24" width="16" height="16">
            <path fill="currentColor" d="M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zm-6.6 8.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"/>
        </svg>
        <span>Tryb offline</span>
    </div>
</div>

<!-- Modal szczegółów wiadomości -->
<div id="message-modal" class="modal hidden">
    <div class="modal-content">
        <div class="modal-header">
            <button id="modal-back" class="icon-btn">
                <svg viewBox="0 0 24 24" width="24" height="24">
                    <path fill="currentColor" d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                </svg>
            </button>
            <h2>Wiadomość</h2>
            <div class="modal-actions"></div>
        </div>

        <div id="message-detail" class="message-detail">
            <div class="message-detail-header">
                <h3 id="detail-subject" class="detail-subject"></h3>
                <div class="detail-meta">
                    <span id="detail-sender" class="detail-sender"></span>
                    <span id="detail-date" class="detail-date"></span>
                </div>
            </div>
            <div id="detail-body" class="detail-body"></div>
            <div id="detail-attachments" class="detail-attachments hidden">
                <h4>Załączniki:</h4>
                <ul id="attachments-list"></ul>
            </div>
        </div>

        <div id="message-detail-loader" class="message-detail-loader hidden">
            <div class="spinner"></div>
        </div>
    </div>
</div>

<!-- Toast notifications -->
<div id="toast-container" class="toast-container"></div>

<!-- Service Worker registration -->
<script>
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('sw.js')
                .then(reg => console.log('Service Worker zarejestrowany'))
                .catch(err => console.log('Błąd rejestracji SW:', err));
        });
    }
</script>

<!-- Główny skrypt aplikacji -->
<script src="app.js?v=1.4"></script>
</body>
</html>
